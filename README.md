# Automated FreeBSD 15.0 VM setup for development

–ï—Å–ª–∏ –∫—Ä–∞—Ç–∫–æ ‚Äî —ç—Ç–æ **–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–æ–π FreeBSD 15.0 —Å –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (jails, ZFS, Go)**.

---

## üìã **–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ/–∏–∑–º–µ–Ω–µ–Ω–æ:**

–°–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `vbox/` —Å –Ω–∞–±–æ—Ä–æ–º —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ `Makefile` –¥–ª—è:

### 1. **`Makefile`** ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —É–ø—Ä–∞–≤–ª—è—é—â–∏–π —Å–∫—Ä–∏–ø—Ç
- –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ FreeBSD 15.0
- –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ç–∞–ª–æ–Ω–Ω–æ–π VM –≤ VirtualBox
- –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ VM –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ (`joker` ‚Äî –∏–º—è –ø—Ä–∏–º–µ—Ä–∞)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–∫–∞–º–∏, —Å–µ—Ç—å—é (–ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤ SSH 2222 ‚Üí 22)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ

### 2. **–°–∫—Ä–∏–ø—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** (`first-boot.sh`, `install-sudo.sh`, `install-iocage.sh`)
- –ü–µ—Ä–≤–∏—á–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è FreeBSD
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è `joker` —Å –¥–æ—Å—Ç—É–ø–æ–º `sudo` –±–µ–∑ –ø–∞—Ä–æ–ª—è
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ **iocage** (—Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è jail'–∞–º–∏ FreeBSD)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH-–∫–ª—é—á–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

### 3. **–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å VM**
- **`joker`** ‚Äî —Å–∫—Ä–∏–ø—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ SSH-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ VM
- **`joker-run`** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏–ª–∏ –∫–æ–º–∞–Ω–¥ –≤–Ω—É—Ç—Ä–∏ VM
- **`vbox-manage-path.sh`** ‚Äî –∫—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ `VBoxManage`
- **`wait-for-poweroff.sh`** ‚Äî –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã–∫–ª—é—á–µ–Ω–∏—è VM

### 4. **–†–∞–±–æ—Ç–∞ —Å ZFS**
- `setup-workpool.sh` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ ZFS pool –Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–º –¥–∏—Å–∫–µ
- `create-workpool.sh` ‚Äî –∑–∞–≥–æ—Ç–æ–≤–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –ø—É–ª–∞

---

## üéØ **–î–ª—è —á–µ–≥–æ —ç—Ç–æ –Ω—É–∂–Ω–æ?**

1. **–ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ** ‚Äî –æ–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ (`make create-joker`) —Å–æ–∑–¥–∞—ë—Ç –≥–æ—Ç–æ–≤—É—é VM.
2. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å** ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∞ –≤ –∫–æ–¥–µ, —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –º–∞—à–∏–Ω–∞—Ö.
3. **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞/—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî 
   - –ì–æ—Ç–æ–≤–∞—è —Å—Ä–µ–¥–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å FreeBSD jails
   - –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Go, Git, ZFS
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–æ–º–∞–Ω–¥—ã/—Å–∫—Ä–∏–ø—Ç—ã —Å —Ö–æ—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ VM
4. **–û–±—É—á–µ–Ω–∏–µ** ‚Äî –º–æ–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å FreeBSD, –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—è –æ—Å–Ω–æ–≤–Ω—É—é —Å–∏—Å—Ç–µ–º—É.

---

## üñ•Ô∏è **–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**

```bash
cd vbox
make create-freebsd    # —Å–∫–∞—á–∞—Ç—å –æ–±—Ä–∞–∑ –∏ —Å–æ–∑–¥–∞—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—É—é VM
make create-joker      # —Å–æ–∑–¥–∞—Ç—å —Ä–∞–±–æ—á—É—é VM "joker"
make start-joker       # –∑–∞–ø—É—Å—Ç–∏—Ç—å (–∞–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)

./joker uname -a       # –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –≤ VM
./joker-run test.sh    # –∑–∞–ø—É—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤ VM

make stop-joker        # –≤—ã–∫–ª—é—á–∏—Ç—å VM
make clean             # –ø–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
```

---

## üìù **–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**

- **–°–Ω–∞–ø—à–æ—Ç—ã** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è linked clone –æ—Ç —Å–Ω–∞–ø—à–æ—Ç–∞ `initial` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è
- **SSH –¥–æ—Å—Ç—É–ø** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π, –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–∞ 2222
- **–î–æ–ø. –¥–∏—Å–∫** ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π ZFS pool –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
- **–ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Linux, macOS, Windows (—á–µ—Ä–µ–∑ Git Bash)

–≠—Ç–æ **–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∫ –∫–æ–¥ (IaC)** –¥–ª—è FreeBSD-–æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ VirtualBox, —É–¥–æ–±–Ω–∞—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∏–∑—É—á–∞—é—â–∏—Ö FreeBSD –∏–ª–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å jail-—Å–∏—Å—Ç–µ–º–∞–º–∏.
